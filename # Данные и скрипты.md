# Данные и скрипты

Добавление моделей ИИ

| Name | Size | Context | Input | Description |
| --- | --- | --- | --- | --- |

| ✅ deepseek-v3.1:617b-cloud | - | 160000 | Text | DeepSeek‑R1, крупномасштабный трансформер, разработанный компанией DeepSeek. |
| ✅ gpt-oss:120b-cloud | - | 128000 | Text | ChatGPT, модель языка, созданная компанией OpenAI на базе архитектуры GPT‑4. Обучающий датасет охватывает информацию до июня 2024 года. |
| ✅ gpt-oss:20b-cloud |  - | 128000 | Text | Модель GPT‑4 от OpenAI, часть семейства «ChatGPT». Это трансформер‑система, обученная на огромном корпусе текста (от Java‑кодов до художественной литературы) и способная вести диалог, отвечать на вопросы, генерировать тексты, помогать с программированием, переводами и многим другим. Датасет обновлён до сентября 2023 года, а знания о событиях и фактах до 2025 года. |
| ✅ qwen3-coder:480b-cloud | - | 256000 | Text | Qwen3 — это крупномасштабная языковая модель от Alibaba с улучшенными возможностями понимания и генерации текста. Она подходит для сложных задач, поддерживает многоязычность и обеспечивает точные, естественные ответы. |
| ✅ qwen3-vl:235b-cloud | - | 256000 | Text | Qwen — сверхмасштабная языковая модель, разработанная Alibaba Cloud. Поддерживает мультиязычное взаимодействие, включая китайский, английский и русский языки. Способна генерировать тексты, отвечать на сложные вопросы, проводить логические рассуждения и оказывать помощь в аналитических задачах.|
| ✅ minimax-m2:cloud | - | 128000 | Text | MiniMax-M2 — полезный ИИ-ассистент, созданный компанией MiniMax. Мои знания обновлены до июня 2025 года. Может помочь вам с различными задачами, отвечать на вопросы и вести диалог. |
|✅ glm-4.6:cloud | - | 198000 | Text |  Языковая модель GLM, разработанная компанией Zhipu AI. Обучена на большом объёме текстовых данных, что позволяет понимать и генерировать тексты на различных языках, включая русский. |

```aql
// 1. Добавляем модели ИИ
FOR model IN [
  { _key: "deepseek-v3.1:617b-cloud", name: "deepseek-v3.1:617b-cloud", provider: "ollama.local", context_window: 160000, cost_per_1k_tokens: 0 },
  { _key: "gpt-oss:120b-cloud", name: "gpt-oss:120b-cloud", provider: "ollama.local", context_window: 128000, cost_per_1k_tokens: 0 },
  { _key: "gpt-oss:20b-cloud", name: "gpt-oss:20b-cloud", provider: "ollama.local", context_window: 128000, cost_per_1k_tokens: 0 },
  { _key: "qwen3-coder:480b-cloud", name: "qwen3-coder:480b-cloud", provider: "ollama.local", context_window: 256000, cost_per_1k_tokens: 0 },
  { _key: "qwen3-vl:235b-cloud", name: "qwen3-vl:235b-cloud", provider: "ollama.local", context_window: 256000, cost_per_1k_tokens: 0 },
  { _key: "minimax-m2:cloud", name: "minimax-m2:cloud", provider: "ollama.local", context_window: 128000, cost_per_1k_tokens: 0 },
  { _key: "glm-4.6:cloud", name: "glm-4.6:cloud", provider: "ollama.local", context_window: 198000, cost_per_1k_tokens: 0 }
]
UPSERT { _key: model._key }
INSERT model
UPDATE model
IN AI_Models

// 2. Добавляем системные словари
LET dicts = [
  {
    _key: "step_types",
    values: ["ambiguity_loop", "simple_generation", "quality_gate", "compliance_check"]
  },
  {
    _key: "prompt_categories",
    values: ["Business Requirements", "Functional Requirements", "API", "Security"]
  }
]

FOR d IN dicts
  UPSERT { _key: d._key }
  INSERT d
  UPDATE d
  IN Dictionaries
```

Создаем коллекцию **StageTemplates** и наполняем её

```aql
FOR t IN [
  {
    _key: "tpl_brief_refinement",
    name: "Проработка Брифа (Полный цикл)",
    description: "Анализ неопределенностей, Q&A сессия, генерация ТЗ и сравнение версий.",
    steps: [
      {
        id: "step_1",
        name: "Ввод и Анализ",
        type: "ai_analysis",
        order: 1,
        config: {
          model_id: "gpt-oss:120b-cloud",
          system_prompt_id: "system_ambiguity_check"
        }
      },
      {
        id: "step_2",
        name: "Уточнение (Q&A)",
        type: "qa_check",
        order: 2,
        config: {
          model_id: "gpt-oss:120b-cloud",
          system_prompt_id: "system_quality_check"
        }
      },
      {
        id: "step_3",
        name: "Генерация",
        type: "generation",
        order: 3,
        config: {
          model_id: "gpt-oss:120b-cloud",
          system_prompt_id: "system_generation"
        }
      },
      {
        id: "step_4",
        name: "Сравнение и Финал",
        type: "review",
        order: 4,
        config: {}
      }
    ]
  },
  {
    _key: "tpl_quick_fix",
    name: "Быстрое улучшение",
    description: "Простая вычитка и улучшение стиля без вопросов.",
    steps: [
      {
        id: "step_1",
        name: "Ввод текста",
        type: "simple_input",
        order: 1,
        config: {}
      },
      {
        id: "step_2",
        name: "Генерация",
        type: "generation",
        order: 2,
        config: {
          model_id: "gpt-oss:120b-cloud",
          system_prompt_id: "system_generation"
        }
      }
    ]
  }
]
UPSERT { _key: t._key }
INSERT t
UPDATE t
IN StageTemplates
```

================

## Switch node n8n

{
  "nodes": [
    {
      "parameters": {
        "dataType": "string",
        "value1": "{{ $json.body.action }}",
        "rules": {
          "rules": [
            {
              "value2": "getProjectDetails",
              "output": 0
            },
            {
              "value2": "listPrompts",
              "output": 1
            },
            {
              "value2": "listProjects",
              "output": 2
            },
            {
              "value2": "createProject",
              "output": 3
            },
            {
              "value2": "listTemplates",
              "output": 4
            },
            {
              "value2": "addStage",
              "output": 5
            }
          ]
        }
      },
      "id": "switch-fixed",
      "name": "Switch Action Fixed",
      "type": "n8n-nodes-base.switch",
      "typeVersion": 1,
      "position": [680, 300]
    }
  ]
}